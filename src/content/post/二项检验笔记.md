---
title: 二项检验笔记
publishDate: 2024-10-03 13:15:00
tags: 
   - 非参数检验
description: '介绍非参数检验中的二项检验方法，以及与参数检验的对比'
language: '中文'
---

## 定义

二项检验是一种非参数检验(model-free), 用于检验一个具有二元结果的变量是否满足要求。例如: 产品的次品率是否符合要求，一个硬币是否是公平的...

二项检验的假设如下

- 感兴趣的变量应该是一个二元结果，意味着它只能取两个值中的一个（例如，抛硬币（头/尾），是否有疾病（是/否），道德（死/活））。这有时也被称为二分法变量。
- 观察应该是独立的，也就是说一个观察对另一个观察的概率没有任何影响。
- 实验应该有一个固定的样本量，表示为n。
- 所有独立的观察结果应该具有相同的概率。这类似于独立假设，可以通过随机抽样来实现。

简单来说就是 BINS: Binary, Independent, N samples and Same probability.

## 与z检验的对比

z检验是一种参数检验，即我们知道总体的均值和标准差，然后用样本的均值和标准差来推断总体的均值是否满足要求。

我们用统计量 $ z = \frac{\bar{x} - \mu}{\sigma/\sqrt{n}} $ 来检验总体均值是否满足要求。

相较于 z 检验，二项检验更加灵活，因为它不需要知道总体的均值和标准差，只需要知道样本的二元结果即可。他们的对比如下表所示:

|  | 二项检验 | z检验 |
| --- | --- | --- |
| 总体 | 二元结果 | 连续结果 |
| 参数 | 无 | 有 |
| 样本 | 二元结果 | 连续结果 |
| 假设 | 二元结果是否满足要求 | 总体均值是否满足要求 |

总的来说，二项检验容易实施，也是exact test，但是它的置信区间比较宽，而且只能用于二元结果的检验。

## 步骤

先看一个例子

!!! note
    某机器生产一种产品，当次品率小于等于 5% 时可以认为该机器工作正常:当大于 5% 时对机器进行检修.某天抽出 15 件产品，发现 3 件次品，问该天机器工作是否正常?[^1]

我们可能会直接使用 3/15 = 0.2 > 0.05 来判断机器是否正常，但是这种方法是不准确的，因为我们只抽取了 15 件产品，引入了偶然性，无法判断到底是随机效应还是真的次品率超过了 5%.

我们可以使用二项检验来解决这个问题。
设每个产品为次品的概率为 $p$， 且是否为次品相互独立.困此，这个假设
检验问题的原假设 $H_0$ 和备择假设 $H_1$ 可以写为
$$
    H_0: p \leq 0.05 \leftrightarrow H_1: p > 0.05
$$
我们知道，如果次品太多，就要拒绝 $H_0$. 所以取检验统计量 T 为次品的总个数.
可以得到 T 服从二项分布 B(15, 0.05). 查二项分布表可得
$$
    P\{T\leq 2\}=0.9638
$$
如果取显著性水平 $\alpha= 0.05$，那么拒绝域为 $T>2$. 现 T 的观测值为 3，所以拒绝
$H_0$ ， 即认为该天机器工作不正常.检验的 $p$ 值为
$$
    P\{T\geq 3\}=1-P\{T\leq 2\}=0.0362
$$

在这里，查阅二项分布表是一个很麻烦的事情，并且，如果我们计算实际的置信水平，可以发现，实际的置信水平并不是 0.05，而是略有偏差，这是因为二项分布表是离散的，而我们的检验统计量是连续的，所以我们需要使用连续的分布来近似二项分布。

### 双边检验

设检验统计量 $T$ 为 $n$ 重 Bernoulli 试验中成功的次数，则 $T$ 服从二项分布 $B(n,p)$ 对于 $n\leqslant20$ 和选定的 $p$ ,附表 2 中列出了 $T$ 的零分布的值. 对于 $n>20$, 我们可以用正态分布逼近，即 $T$ 的 $q$ 分位数 $x_q$ 可以由下式近似给出.

$$x_q=np+z_q\sqrt{np(1-p)},$$

其中 $z_q$是标准正态分布的 $q$ 分位数.
显著性水平 $\alpha$ 的拒绝域对应于 $T$ 的零分布的两边，其中左边水平为 $\alpha/2$ ,右边水平为 $1-\alpha/2$ 对于 $n\leqslant20$ 和给定的 $p_0$ ,我们可以查附表2而得到二项分布 $B(n,p_{0})$ 的 $\alpha/2$ 分位数 $b(\alpha/2,n)$ 和 $1-\alpha/2$ 分位数 $b(1-\alpha/2,n)$ ,使得

$$P\{Y\leqslant b(\alpha/2,n)\}\leqslant\frac{\alpha}{2},\\P\{Y\leqslant b(1-\alpha/2,n)\}\geqslant1-\frac{\alpha}{2},$$

### 单边检验

类似于双边检验，只需要考察

$$
P\{Y\leqslant b(\alpha,n)\}\leqslant\alpha
$$
或
$$
P\{Y\leqslant b(1-\alpha,n)\}\geqslant1-\alpha
$$
即可

国庆节间写于6教6A214, 是日晴空万里，心情愉悦。早上看了很久《唐朝诡事录》，闲来无事，写写笔记，也是一种
放松。

[^1]: 例子来自于《应用非参数统计（第二版）》，薛留根编著
